<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>sheet js</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.1/xlsx.full.min.js"></script>
    <style>
        /* layout.css Style */
        .upload-drop-zone {
            height: 200px;
            border-width: 2px;
            margin-bottom: 20px;
        }

        /* skin.css Style*/
        .upload-drop-zone {
            color: #ccc;
            border-style: dashed;
            border-color: #ccc;
            line-height: 200px;
            text-align: center
        }
        .upload-drop-zone.drop {
            color: #222;
            border-color: #222;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="row">
        <center><h1>Welcome</h1></center>
    </div>
</div>
<div id="wrapper">

    <div class="container">
        <div class="panel panel-default">
            <div class="panel-heading"><strong>Upload Files</strong> <small>Bootstrap files upload</small></div>
            <div class="panel-body">

                <!-- Standar Form -->
                <h4>Select files from your computer</h4>
                <form action="" method="post" enctype="multipart/form-data" id="js-upload-form">
                    <div class="form-inline">
                        <div class="form-group">
                            <input type="file" name="files[]" id="js-upload-files" multiple>
                        </div>
                        <button type="submit" class="btn btn-sm btn-primary" id="js-upload-submit">Upload files</button>
                    </div>
                </form>

                <!-- Drop Zone -->
                <h4>Or drag and drop files below</h4>
                <div class="upload-drop-zone" id="drop-zone">
                    <input type="file" name="files[]" id="js-upload-files" multiple>
                    Just drag and drop files here
                </div>

                <!-- Progress Bar -->
                <div class="progress">
                    <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
                        <span class="sr-only">60% Complete</span>
                    </div>
                </div>
    <!--<input type="file" id="input-excel" />-->
    <table class="table table-bordered">
        <thead id="theadHtml">

        </thead>
        <tbody id="tbodyHtml">

        </tbody>
    </table>
</div>
<script>
    $('#input-excel').change(function(e){
        var rABS = true;
        var files = e.target.files;
        var i,f;
        for (i = 0; i != files.length; ++i) {
            f = files[i];
            var reader = new FileReader();
            var name = f.name;
            reader.onload = function(e) {
                var data = e.target.result;
                var workbook;
                if(rABS) {
                    /* if binary string, read with type 'binary' */
                    workbook = XLSX.read(data, {type: 'binary'});
                } else {
                    /* if array buffer, convert to base64 */
                    var arr = fixdata(data);
                    workbook = XLSX.read(btoa(arr), {type: 'base64'});
                }
                var arrayOfData=to_json(workbook);
                var theadHtml="";
                var tbodyHtml="";
                $.each(arrayOfData, function (index,subArray) {
                    for (var key in subArray) {
                        if(key == 0){
                            theadHtml+="<tr>";
                            for (var key1 in subArray[key]) {
                                theadHtml += '<th>'+key1+'</th>';
                            }
                            theadHtml+="</tr>";
                        }
                        tbodyHtml+="<tr>";

                        for (var key1 in subArray[key]) {
                            tbodyHtml += '<td>'+subArray[key][key1]+'</td>';
                        }
                        tbodyHtml+="</tr>";

                    }
                });
                $('#theadHtml').html(theadHtml);
                $('#tbodyHtml').html(tbodyHtml);
                /* DO SOMETHING WITH workbook HERE */
            };
            reader.readAsBinaryString(f);
        }
    });
    function to_json(workbook) {
        var result = {};
        workbook.SheetNames.forEach(function(sheetName) {
            var roa = XLS.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
            if(roa.length > 0){
                result[sheetName] = roa;
            }
        });
        return result;
    }
    $('.file_upload').file_upload();


</script>
</body>
</html>